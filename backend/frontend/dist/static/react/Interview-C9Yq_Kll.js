import{r as t,j as e,u as E}from"./index-oLRZV56Y.js";import{u as j}from"./FetchData-CeJWyWSx.js";import{u as L,c as _,i as N,a as Q}from"./Navbar-Dnyz2665.js";import{T as y,L as I}from"./ListenPerson-74idL2kz.js";import{B as p}from"./Button-DiQE_urz.js";import{a as v}from"./index-Br0q4W-C.js";const S=t.forwardRef(({bsPrefix:c,bg:s="primary",pill:r=!1,text:o,className:n,as:a="span",...l},d)=>{const i=L(c,"badge");return e.jsx(a,{ref:d,...l,className:_(n,i,r&&"rounded-pill",o&&`text-${o}`,s&&`bg-${s}`)})});S.displayName="Badge";const T=({answerId:c})=>{const[s,r]=t.useState(null),[o,n]=t.useState(!0),[a,l]=t.useState(null);if(j({method:"GET",app_name:"interview",url:"answer/",id:c,setData:r,setLoading:n,setError:l}),o)return e.jsx("div",{children:"Loading..."});if(a)return e.jsx("div",{children:a});if(!s)return e.jsx("div",{children:"No answer found"});const d=()=>{y(s.text)};return e.jsx("div",{className:"text-center pb-5",children:e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsx("div",{className:"border p-3 rounded bg-light text-center",children:e.jsx("h1",{className:"mb-0",children:s.text})}),e.jsx(p,{variant:"secondary",onClick:d,children:e.jsx(N,{})})]})})},P=({correctAnswerId:c,setCorrect:s})=>{const[r,o]=t.useState(null),[n,a]=t.useState(!0),[l,d]=t.useState(null),[i,x]=t.useState(!1),[h,m]=t.useState(null),[u,f]=t.useState(null);if(j({method:"GET",app_name:"interview",url:"answer/",id:c,setData:o,setLoading:a,setError:d}),n)return e.jsx("div",{children:"Loading..."});if(l)return e.jsx("div",{children:l});if(!r)return e.jsx("div",{children:"No answer found"});const b=()=>{try{x(!0);const w=I("en-US");f(w),w.onresult=g=>{const k=g.resultIndex,C=g.results[k][0].transcript;m(C)},w.start()}catch(w){console.log("error: ",w)}},A=()=>{u&&u.stop(),h&&(s(h.toLowerCase()===r.text.toLowerCase()),x(!1))};return e.jsxs("div",{children:[h&&e.jsxs("h3",{children:["Your answer: ",h]}),e.jsxs("div",{className:"d-flex justify-content-center gap-3 mt-3",children:[e.jsx(p,{onClick:b,children:"Answer"}),e.jsx(p,{onClick:A,disabled:!i,children:"Stop"})]})]})},G=({actualQuestionNumber:c,questionId:s,setCorrect:r,correct:o})=>{const[n,a]=t.useState(null),[l,d]=t.useState(!0),[i,x]=t.useState(null),[h,m]=t.useState(null);if(j({method:"GET",app_name:"interview",url:"question/",id:s,setData:a,setLoading:d,setError:x}),j({method:"GET",app_name:"interview",url:"questions-correct-answers/",id:s,setData:m,setLoading:d,setError:x}),l)return e.jsx("div",{children:"Loading..."});if(i)return e.jsx("div",{children:i});if(!n)return e.jsx("div",{children:"No question found"});if(!h)return e.jsx("div",{children:"No correct answer found"});const u=()=>{y(n.text)};return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-center align-items-center gap-2",children:[e.jsxs("h1",{className:"fw-bold fs-1",children:["Q",c+1,": ",n.text," "]}),e.jsx(p,{variant:"secondary",onClick:u,children:e.jsx(N,{})})]}),e.jsx("div",{className:"d-flex flex-column pt-3 pb-3",children:e.jsxs("div",{className:"border p-3 rounded bg-light text-center",children:[e.jsx("p",{className:"fw-bold text-secondary",children:"Probably Answers"}),n.answers.map(f=>e.jsx(T,{answerId:f},f))]})}),o!==null&&e.jsxs("h3",{children:["Your answer is correct ? ",o?"Yes":"No"]}),e.jsx(P,{correctAnswerId:h.answers[0],setCorrect:r})]})},q=({questions:c})=>{const[s,r]=t.useState(0),[o,n]=t.useState(null),a=()=>{s<c.length-1&&r(s+1)},l=()=>{s>0&&r(s-1)};return t.useEffect(()=>{n(null)},[s]),e.jsxs("div",{className:"container text-center align-items-center",children:[e.jsxs("h3",{className:"fw-bold pb-3",children:["You are answering question ",e.jsxs(S,{bg:"primary",children:[" ",s+1," "]})]}),e.jsx(G,{actualQuestionNumber:s,questionId:c[s],setCorrect:n,correct:o}),e.jsxs("div",{className:"d-flex justify-content-center gap-3 mt-3",children:[e.jsx(p,{onClick:l,variant:"secondary",children:"Previous"}),e.jsx(p,{onClick:a,variant:"info",children:"Next"})]})]})},V=()=>{const{id:c}=E(),[s,r]=t.useState(null),[o,n]=t.useState(!0),[a,l]=t.useState(null),[d,i]=t.useState(null),x=localStorage.getItem("authToken");j({method:"GET",app_name:"interview",url:"interview/",id:Number(c),setData:r,setLoading:n,setError:l}),console.log("userToken",x);async function h(){try{const m={user_token:x,game_name:"Fake Job Interview"},u=await v.post("http://127.0.0.1:8000/payment/api/can_play_game/",m);console.log("response",u),u.status!==200?i(!1):i(!0)}catch(m){console.error("Error checking can play interview:",m),i(!1)}}return t.useEffect(()=>{if(h(),console.log("montado"),d===!0){async function m(){try{const u={user_token:x,game_name:"Fake Job Interview"},f=await v.post("http://127.0.0.1:8000/payment/api/discount_game_usage/",u);console.log("response",f),f.status!==200?i(!1):(console.log("consumação -1"),i(!0))}catch(u){console.error("Error checking can play interview:",u),i(!1)}}m()}},[s]),d?o?e.jsx("div",{children:"Loading..."}):a?e.jsx("div",{children:a}):s?(console.log(s),e.jsxs(e.Fragment,{children:[e.jsx(Q,{}),e.jsxs("div",{className:"container text-center align-items-center pt-5",children:[e.jsx("h3",{children:s.level}),e.jsx("h5",{className:"pb-5",children:s.interview_type}),e.jsx(q,{questions:s.questions})]})]})):e.jsx("div",{children:"No interview found"}):e.jsx("div",{children:"Game not available"})};export{V as InterviewView,V as default};
