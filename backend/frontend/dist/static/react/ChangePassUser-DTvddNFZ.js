import{r as t,a as N,j as e}from"./index-oLRZV56Y.js";import{B as b}from"./Button-DiQE_urz.js";import{F as s}from"./Form-BQaihP3E.js";import{a as S}from"./Navbar-Dnyz2665.js";import"./Col-D3TImVBo.js";const T=()=>{const[c,m]=t.useState(""),[n,p]=t.useState(""),[i,f]=t.useState(""),[u,a]=t.useState(null),[g,l]=t.useState(!1),[h,o]=t.useState(!1),{setIsAuthenticated:x}=N(),C=r=>{m(r.target.value)},j=r=>{p(r.target.value)},P=r=>{f(r.target.value)},y=async r=>{if(r.preventDefault(),o(!0),a(null),n!==i){a("New passwords do not match."),o(!1);return}try{const d=localStorage.getItem("authToken");if(!d){a("User not authenticated."),o(!1),x(!1);return}const w=await fetch("https://0.0.0.0:8000/user/api/change_password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_token:d,current_password:c,new_password:n})});if(w.ok)l(!0),a(null),console.log("Password changed successfully!");else{const v=await w.json();a(v.message||"Failed to change password."),l(!1)}}catch{a("Network error, please try again."),l(!1)}finally{o(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(S,{}),e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"70vh"},children:e.jsx("div",{className:"w-100",style:{maxWidth:"400px",marginTop:"5vh"},children:e.jsxs(s,{onSubmit:y,children:[e.jsxs(s.Group,{className:"mb-3",controlId:"formCurrentPassword",children:[e.jsx(s.Label,{children:"Current Password"}),e.jsx(s.Control,{type:"password",placeholder:"Enter current password",value:c,onChange:C,required:!0})]}),e.jsxs(s.Group,{className:"mb-3",controlId:"formNewPassword",children:[e.jsx(s.Label,{children:"New Password"}),e.jsx(s.Control,{type:"password",placeholder:"Enter new password",value:n,onChange:j,required:!0})]}),e.jsxs(s.Group,{className:"mb-3",controlId:"formConfirmPassword",children:[e.jsx(s.Label,{children:"Confirm New Password"}),e.jsx(s.Control,{type:"password",placeholder:"Confirm new password",value:i,onChange:P,required:!0})]}),u&&e.jsx("div",{style:{color:"red"},children:u}),g&&e.jsx("div",{style:{color:"green"},children:"Password changed successfully!"}),e.jsx(b,{variant:"primary",type:"submit",disabled:h,className:"w-100",children:h?"Changing...":"Change Password"})]})})})]})};export{T as default};
