import{r as n,j as e}from"./index-oLRZV56Y.js";import{u as ne}from"./FetchData-CeJWyWSx.js";import{B as c}from"./Button-DiQE_urz.js";import{T as se,L as re}from"./ListenPerson-74idL2kz.js";import{u as U,c as H,f as ae,A as oe,e as le,F as W,d as ie,g as ce,C as de,h as ue,a as he}from"./Navbar-Dnyz2665.js";import{a as $}from"./index-Br0q4W-C.js";const D=ae("h4");D.displayName="DivStyledAsH4";const F=n.forwardRef(({className:r,bsPrefix:a,as:d=D,...o},l)=>(a=U(a,"alert-heading"),e.jsx(d,{ref:l,className:H(r,a),...o})));F.displayName="AlertHeading";const z=n.forwardRef(({className:r,bsPrefix:a,as:d=oe,...o},l)=>(a=U(a,"alert-link"),e.jsx(d,{ref:l,className:H(r,a),...o})));z.displayName="AlertLink";const G=n.forwardRef((r,a)=>{const{bsPrefix:d,show:o=!0,closeLabel:l="Close alert",closeVariant:_,className:N,children:p,variant:T="primary",onClose:u,dismissible:h,transition:x=W,...y}=le(r,{show:"onClose"}),i=U(d,"alert"),k=ie(A=>{u&&u(!1,A)}),f=x===!0?W:x,g=e.jsxs("div",{role:"alert",...f?void 0:y,ref:a,className:H(N,i,T&&`${i}-${T}`,h&&`${i}-dismissible`),children:[h&&e.jsx(ce,{onClick:k,"aria-label":l,variant:_}),p]});return f?e.jsx(f,{unmountOnExit:!0,...y,ref:void 0,in:o,children:g}):o?g:null});G.displayName="Alert";const pe=Object.assign(G,{Link:z,Heading:F}),fe=()=>{const[r,a]=n.useState(null),[d,o]=n.useState(!0),[l,_]=n.useState(null),[N,p]=n.useState(!1),[T,u]=n.useState(null),[h,x]=n.useState(Math.floor(Math.random()*226)),[y,i]=n.useState(null),[k,f]=n.useState(!1),[g,A]=n.useState(null),[j,M]=n.useState(null),[O,E]=n.useState(!1),[P,B]=n.useState(null),[R,w]=n.useState(null),S=localStorage.getItem("authToken");if(ne({method:"LIST",app_name:"sentences",url:"sentences/",setData:a,setLoading:o,setError:_}),n.useEffect(()=>{E(!1),M(null),A(null),B(null),f(!1)},[h]),console.log("userToken",S),n.useEffect(()=>{async function t(){try{const s={user_token:S,game_name:"Most Common Sentences"};(await $.post("http://127.0.0.1:8000/payment/api/can_play_game/",s)).status===200?w(!0):w(!1)}catch(s){console.error("Error checking can play interview:",s),w(!1)}}t()},[h,S]),n.useEffect(()=>{async function t(){if(R)try{const s={user_token:S,game_name:"Most Common Sentences"};(await $.post("http://127.0.0.1:8000/payment/api/discount_game_usage/",s)).status===200?console.log("Consumação realizada com sucesso."):(console.log("Erro ao realizar consumação."),w(!1))}catch(s){console.error("Error deducting consumption:",s),w(!1)}}t()},[R,h,S]),!R)return e.jsx("div",{children:"You have reached your most common sentences limit per month"});if(d)return e.jsx("div",{children:"Loading..."});if(l)return e.jsx("div",{children:l});if(!r||r.length===0)return e.jsx("div",{children:"No sentences found"});const L=r[h],Y=()=>{se(L.sentence)},q=()=>{const t=document.querySelector("input");if(t){p(!0);const s=t.value.trim().split(" "),m=L.sentence.trim().split(" "),b=m.map((I,v)=>{var V;const C=((V=s[v])==null?void 0:V.trim().toLowerCase())===I.trim().toLowerCase();return e.jsx("span",{style:{color:C?"green":"red",marginRight:"5px",fontWeight:C?"bold":"normal"},children:s[v]||"_"},v)});u(e.jsx("div",{children:b})),t.value="";const te=m.every((I,v)=>{var C;return((C=s[v])==null?void 0:C.trim().toLowerCase())===I.trim().toLowerCase()});i(te)}},J=()=>{p(!1),u(null),i(null)},K=()=>{p(!1),u(null),i(null),x(t=>(t+1)%r.length)},Q=()=>{p(!1),u(null),i(null),x(Math.floor(Math.random()*r.length))},X=()=>{try{E(!0);const t=re("en-US");A(t),t.onresult=s=>{const m=s.resultIndex,b=s.results[m][0].transcript;M(b)},t.start()}catch(t){console.log("error: ",t)}},Z=()=>{if(g&&g.stop(),!j)return;let t=j;t=t.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,""),B(t.toLowerCase()===L.sentence.toLowerCase()),E(!1)},ee=()=>{f(!k)};return e.jsxs(de,{children:[e.jsx("div",{className:"d-flex justify-content-center",style:{paddingTop:"200px"},children:e.jsx(c,{variant:"primary",onClick:Y,style:{width:"200px",height:"50px"},children:e.jsx(ue,{})})}),e.jsx("div",{className:"d-flex justify-content-center py-5",children:e.jsx("input",{type:"text",className:"form-control w-50 text-center","aria-label":"Text input",placeholder:"Write what you have heard"})}),!N&&e.jsx("div",{className:"d-flex justify-content-center py-0",children:e.jsx(c,{variant:"success",style:{width:"200px",height:"50px"},onClick:q,children:"Verify Sentence"})}),N&&e.jsxs("div",{children:[e.jsx("div",{className:"d-flex justify-content-center py-5",children:e.jsx("div",{children:e.jsxs(pe,{variant:"info text-center",children:[e.jsx("strong",{children:"Result"})," ",T]})})}),e.jsxs("div",{className:"d-flex justify-content-center",style:{gap:"10px",paddingTop:"0px"},children:[y?e.jsx(c,{variant:"primary",onClick:K,style:{width:"150px"},children:"Next Sentence"}):e.jsx(c,{variant:"warning",onClick:J,style:{width:"150px"},children:"Try Again"}),e.jsx(c,{variant:"secondary",onClick:Q,style:{width:"150px"},children:"Generate New Sentence"})]}),j&&e.jsxs("h3",{children:["Your answer: ",j]}),!O&&j&&e.jsx("h3",{children:P?"Correct":"Incorrect"}),y&&e.jsxs("div",{className:"d-flex justify-content-center",style:{gap:"10px",paddingTop:"10px"},children:[e.jsx(c,{variant:"info",onClick:X,style:{width:"200px"},children:"Try to repeat the sentence"}),e.jsxs(c,{variant:"info",onClick:Z,style:{width:"200px"},children:[" ","Stop"]}),e.jsx(c,{variant:"info",onClick:ee,style:{width:"200px"},children:"See the translation in your language"})]}),k&&e.jsx("div",{className:"d-flex justify-content-center py-3",children:e.jsxs("div",{className:"alert alert-info",style:{width:"50%"},children:[e.jsx("strong",{children:"Translation:"})," ",L.translation_ptbr]})})]})]})},Se=()=>(console.log("sentence view"),e.jsxs("div",{children:[e.jsx(he,{}),e.jsx(fe,{})]}));export{Se as SentenceView,Se as default};
